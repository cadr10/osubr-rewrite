// src/DifficultyIcon.ts

import * as d3 from 'd3';

class DifficultyIcon {
  mode: number;
  starRating: number;

  constructor(mode: number, starRating: number) {
    this.mode = mode;
    this.starRating = starRating;
  }

  buildColor(): string {
    const difficultyColourSpectrum = d3
      .scaleLinear<number, string>()
      .domain([0.1, 1.25, 2, 2.5, 3.3, 4.2, 4.9, 5.8, 6.7, 7.7, 9])
      .clamp(true)
      .range([
        "#4290FB",
        "#4FC0FF",
        "#4FFFD5",
        "#7CFF4F",
        "#F6F05C",
        "#FF8068",
        "#FF4E6F",
        "#C645B8",
        "#6563DE",
        "#18158E",
        "#000000",
      ])
      .interpolate(d3.interpolateRgb.gamma(2.2));

    if (this.starRating < 0.1) return "#AAAAAA";
    if (this.starRating >= 9) return "#000000";

    return difficultyColourSpectrum(this.starRating);
  }

  buildStdSVG() {
    return <svg
      xmlns="http://www.w3.org/2000/svg"
      width="0.8em"
      height="0.8em"
      viewBox="0 0 32 32"
    >
      <path
        fill={this.buildColor()}
        d="M16 3.52c6.88 0 12.48 5.6 12.48 12.48S22.88 28.48 16 28.48c-6.88 0-12.48-5.6-12.48-12.48S9.12 3.52 16 3.52m0-2.56c-2.016 0-4 .384-5.856 1.184a15.151 15.151 0 00-4.768 3.232c-1.408 1.376-2.464 2.976-3.232 4.768C1.344 12 .96 13.984.96 16s.384 4 1.184 5.856a15.151 15.151 0 003.232 4.768c1.376 1.408 2.976 2.464 4.768 3.232 1.856.8 3.84 1.184 5.856 1.184s4-.384 5.856-1.184a15.151 15.151 0 004.768-3.232c1.408-1.376 2.464-2.976 3.232-4.768.8-1.856 1.184-3.84 1.184-5.856s-.384-4-1.184-5.856a15.151 15.151 0 00-3.232-4.768c-1.376-1.408-2.976-2.464-4.768-3.232A14.737 14.737 0 0016 .96zm0 7.424c-4.192 0-7.616 3.424-7.616 7.616s3.424 7.616 7.616 7.616 7.616-3.424 7.616-7.616S20.192 8.384 16 8.384z"
      />
    </svg>;
  }

  buildTaikoSVG() {
    return <svg
      xmlns="http://www.w3.org/2000/svg"
      width="0.8em"
      height="0.8em"
      viewBox="0 0 32 32"
    >
      <path
        fill="${this.buildColor()}"
        d="M16 6.4c-5.312 0-9.6 4.288-9.6 9.6s4.288 9.6 9.6 9.6 9.6-4.288 9.6-9.6-4.288-9.6-9.6-9.6zM9.6 16c0-2.976 2.048-5.472 4.8-6.208v12.416c-2.752-.736-4.8-3.232-4.8-6.208zm8 6.208V9.792c2.752.736 4.8 3.232 4.8 6.208s-2.048 5.472-4.8 6.208zM16 3.52c6.88 0 12.48 5.6 12.48 12.48S22.88 28.48 16 28.48c-6.88 0-12.48-5.6-12.48-12.48S9.12 3.52 16 3.52m0-2.56c-2.016 0-4 .384-5.856 1.184a15.151 15.151 0 00-4.768 3.232c-1.408 1.376-2.464 2.976-3.232 4.768C1.344 12 .96 13.984.96 16s.384 4 1.184 5.856a15.151 15.151 0 003.232 4.768c1.376 1.408 2.976 2.464 4.768 3.232 1.856.8 3.84 1.184 5.856 1.184s4-.384 5.856-1.184a15.151 15.151 0 004.768-3.232c1.408-1.376 2.464-2.976 3.232-4.768.8-1.856 1.184-3.84 1.184-5.856s-.384-4-1.184-5.856a15.151 15.151 0 00-3.232-4.768c-1.376-1.408-2.976-2.464-4.768-3.232A14.737 14.737 0 0016 .96z"
      />
    </svg>;
  }

  buildCatchSVG() {
    return <svg
      xmlns="http://www.w3.org/2000/svg"
      width="0.8em"
      height="0.8em"
      viewBox="0 0 32 32"
    >
      <path
        fill="${this.buildColor()}"
        d="M16 3.52c6.88 0 12.48 5.6 12.48 12.48S22.88 28.48 16 28.48c-6.88 0-12.48-5.6-12.48-12.48S9.12 3.52 16 3.52m0-2.56c-2.016 0-4 .384-5.856 1.184a15.151 15.151 0 00-4.768 3.232c-1.408 1.376-2.464 2.976-3.232 4.768C1.344 12 .96 13.984.96 16s.384 4 1.184 5.856a15.151 15.151 0 003.232 4.768c1.376 1.408 2.976 2.464 4.768 3.232 1.856.8 3.84 1.184 5.856 1.184s4-.384 5.856-1.184a15.151 15.151 0 004.768-3.232c1.408-1.376 2.464-2.976 3.232-4.768.8-1.856 1.184-3.84 1.184-5.856s-.384-4-1.184-5.856a15.151 15.151 0 00-3.232-4.768c-1.376-1.408-2.976-2.464-4.768-3.232A14.737 14.737 0 0016 .96zM19.712 9.6c1.344 0 2.4-1.088 2.4-2.4s-1.088-2.4-2.4-2.4-2.4 1.088-2.4 2.4 1.056 2.4 2.4 2.4zm0 2.4c-1.344 0-2.4 1.088-2.4 2.4s1.056 2.4 2.4 2.4 2.4-1.088 2.4-2.4-1.088-2.4-2.4-2.4zm-7.424 0c-1.344 0-2.4 1.088-2.4 2.4s1.056 2.4 2.4 2.4 2.4-1.088 2.4-2.4-1.088-2.4-2.4-2.4zm9.792 7.424c0-1.344-1.088-2.4-2.4-2.4s-2.4 1.088-2.4 2.4 1.056 2.4 2.4 2.4 2.4-1.088 2.4-2.4zm-5.568-4.864c0-1.344-1.088-2.4-2.4-2.4s-2.4 1.056-2.4 2.4 1.056 2.4 2.4 2.4 2.4-1.088 2.4-2.4zm0 9.728c0-1.312-1.088-2.4-2.4-2.4s-2.4 1.088-2.4 2.4 1.056 2.4 2.4 2.4 2.4-1.056 2.4-2.4z"
      />
    </svg>;
  }

  buildManiaSVG() {
    return <svg
      xmlns="http://www.w3.org/2000/svg"
      width="0.8em"
      height="0.8em"
      viewBox="0 0 32 32"
    >
      <path
        fill="${this.buildColor()}"
        d="M16 25.664c-.896 0-1.6-.704-1.6-1.6V7.936c0-.896.704-1.6 1.6-1.6s1.6.704 1.6 1.6v16.128c0 .896-.704 1.6-1.6 1.6zm-3.52-6.144v-7.04c0-.896-.704-1.6-1.6-1.6s-1.6.704-1.6 1.6v7.04c0 .896.704 1.6 1.6 1.6s1.6-.704 1.6-1.6zm10.24 0v-7.04c0-.896-.704-1.6-1.6-1.6s-1.6.704-1.6 1.6v7.04c0 .896.704 1.6 1.6 1.6s1.6-.704 1.6-1.6zM16 3.52C9.12 3.52 3.52 9.12 3.52 16S9.12 28.48 16 28.48c6.88 0 12.48-5.6 12.48-12.48S22.88 3.52 16 3.52m0-2.56c2.016 0 4 .384 5.856 1.184a15.151 15.151 0 014.768 3.232c1.408 1.376 2.464 2.976 3.232 4.768.8 1.856 1.184 3.84 1.184 5.856s-.384 4-1.184 5.856a15.151 15.151 0 01-3.232 4.768c-1.376 1.408-2.976 2.464-4.768 3.232-1.856.8-3.84 1.184-5.856 1.184s-4-.384-5.856-1.184a15.151 15.151 0 01-4.768-3.232c-1.408-1.376-2.464-2.976-3.232-4.768C1.344 20 .96 18.016.96 16s.384-4 1.184-5.856a15.151 15.151 0 013.232-4.768c1.376-1.408 2.976-2.464 4.768-3.232C12 1.344 13.984.96 16 .96z"
      />
    </svg>;
  }

  getSVG() {
    switch (this.mode) {
      case 0:
        return this.buildStdSVG();
      case 1:
        return this.buildTaikoSVG();
      case 2:
        return this.buildCatchSVG();
      case 3:
        return this.buildManiaSVG();
      default:
        return this.buildStdSVG();
    }
  }
}

export default DifficultyIcon;
